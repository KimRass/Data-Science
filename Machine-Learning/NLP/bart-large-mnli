# https://huggingface.co/facebook/bart-large-mnli

from transformers import pipeline
import csv

tag_dir = '/Users/choeseung-won/Documents/Flitto_Data/data_personal/2022-Categroy-Classifier/tags.csv'



def _get_tags(tag_dir):
    f = open(tag_dir, 'r', encoding='utf-8')
    rdr = csv.reader(f, delimiter=',')

    return list(rdr)[0]


def inference(classifier_model, sentece):
    tags = _get_tags(tag_dir)

    return classifier_model(sentece, tags, multi_class=True)


def get_model():
    classifier = pipeline("zero-shot-classification", model="facebook/bart-large-mnli")

    return classifier